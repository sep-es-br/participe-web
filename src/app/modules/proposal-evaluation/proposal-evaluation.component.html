<app-template>
  <div class="d-flex justify-content-between">
    <div class="col-12 text-end">
      <a class="search" (click)="toggleSearch()">{{
        (search ? "hide" : "search") | translate
      }}</a>
    </div>
  </div>

  <div *ngIf="search">
    <div class="row mt-2">
      <div class="col-12">
        <div class="row">
          <div class="col-3">
            <label class="form-label">Situação</label>
            <p-dropdown styleClass="d-flex form-control" [options]="proposalStatusOptions" [(ngModel)]="filter.proposalStatus"></p-dropdown>
          </div>
          <div class="col-3">
            <label class="form-label">Microrregião</label>
            <p-dropdown styleClass="d-flex form-control" [options]="microrregionOptions" [(ngModel)]="filter.microrregion"></p-dropdown>
          </div>
          <div class="col-3">
            <label class="form-label">Área Temática</label>
            <p-dropdown styleClass="d-flex form-control" [options]="themeAreaOptions" [(ngModel)]="filter.themeArea"></p-dropdown>
          </div>
          <div class="col-3">
            <label class="form-label">Categoria Orçamentária</label>
            <p-dropdown styleClass="d-flex form-control" [options]="budgetCategoryOptions" [(ngModel)]="filter.budgetCategory"></p-dropdown>
          </div>
        </div>
      </div>
      <div class="col-12">
        <div class="row">
          <div class="col-3">
            <label class="form-label">Órgão</label>
            <p-dropdown styleClass="d-flex form-control" [options]="entityOptions" [(ngModel)]="filter.entity"></p-dropdown>
          </div>
          <div class="col-3">
            <label class="form-label">Proposta Incluída na próxima LOA</label>
            <p-dropdown styleClass="d-flex form-control" [options]="loaIncludedOptions" [(ngModel)]="filter.loaIncluded"></p-dropdown>
          </div>
          <div class="col-3">
            <label class="form-label">Texto</label>
            <input pInputText class="form-control" [(ngModel)]="filter.text"/>
          </div>
          <div class="col-3 mt-auto">
            <button
              pButton
              [icon]="getIcon('pi pi-search')"
              [disabled]="loading"
              (click)="searchHandle()"
              [label]="'search' | translate"
            ></button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div *ngFor="let proposal of proposalList">
    <app-proposal [proposalData]="proposal"></app-proposal>
  </div>

  <ng-container
    *ngIf="showSelectConference"
    [ngTemplateOutlet]="changeConference"
  ></ng-container>
</app-template>

<ng-template #changeConference>
  <p-dialog
    class=""
    modal="true"
    [draggable]="false"
    [style]="{ width: '500px' }"
    [closable]="false"
    [header]="'moderation.label.select_conference' | translate"
    [visible]="showSelectConference"
  >
    <div
      class="conferences-item-select-modal"
      *ngFor="let conference of conferences"
      (click)="selectOtherConference(conference)"
    >
      <h4>{{ conference.name }}</h4>
      <small>{{ conference.description }}</small>
      <div class="date-container">
        <div class="date">
          <i class="pi pi-calendar"></i>
          {{ conference.beginDate }}
        </div>
        <div class="date">
          <i class="pi pi-calendar"></i>
          {{ conference.endDate }}
        </div>
      </div>
    </div>
    <p-footer>
      <div class="action-modal">
        <button
          pButton
          label="Fechar"
          (click)="showSelectConference = false"
        ></button>
      </div>
    </p-footer>
  </p-dialog>
</ng-template>


<div class="card card-w-title mb-3">
  <div class="row">
    <div class="col-6">
      <div class="status-microrregion">
        <span
          class="status-text"
          [ngClass]="{
            evaluated: proposal.status == 'Avaliado',
            'not-evaluated': proposal.status == 'Não Avaliado'
          }"
          >{{ proposal.status }}</span
        >
        <span class="divider">|</span>
        <!-- <span class="microrregion-text ms-4">{{ proposal.microrregion }}</span> -->
        <span class="microrregion-text ms-4">{{ proposal.locality.name }}</span>
      </div>
      <div class="description-text my-2">
        <!-- <p>{{ proposal.descriptionText }}</p> -->
        <p>{{ proposal.description }}</p>
      </div>

      <div class="themearea-budgetcategory">
        <span>Área Temática: </span>
        <!-- <span class="themearea-text">{{ proposal.themeArea }}</span> -->
        <span class="themearea-text">{{ proposal.planItemArea.name }}</span>
        <span class="divider">></span>
        <span>Categoria Orçamentária: </span>
        <span class="budgetcategory-text">{{ proposal.planItem.name }}</span>
      </div>
    </div>
    <!-- Botão fixo na direita, badges de orgaos sem wrap -->
    <div class="col-6 d-flex justify-content-around align-items-center">
      <div class="col-9 d-inline-flex align-content-center flex-wrap">
        <button class="entity-badge pe-none" *ngFor="let entity of proposal.entities">
          {{ entity }}
        </button>
      </div>

      <div>
        <button
          pButton
          icon="fa-solid fa-clipboard-check fa-lg"
          class="py-1 px-2"
          (click)="evaluateProposal(proposal.id)"
        ></button>
      </div>
    </div>
  </div>
</div>

<app-modal [id]="proposal.commentId.toString()" [modalData]="modalData" (confirmed)="confirmedModal()" (closed)="cancel()">
  <div class="row">
    <p-dropdown class="dropdown-modal" [options]="optionsData" [(ngModel)]="selectedOrg" [styleClass]="'w-100'"
      (onChange)="onDropdownChange($event)"></p-dropdown>
    <div class="p-2 field-switch">
      <p-inputSwitch class="input-switch-modal" id="orgPreference" [(ngModel)]="orgHasPreference">
      </p-inputSwitch>
      <label for="orgPreference">{{
        "proposal_evaluation.orgPreference" | translate
        }}</label>
    </div>
  </div>
</app-modal>

<div class="card card-w-title mb-3">
    <div class="row">
      <div class="col-6">
        <div class="evalStatus-locality">
          <span
            class="evalStatus-text"
            [ngClass]="{
              evaluated: proposal.evaluationStatus,
              'not-evaluated': !proposal.evaluationStatus
            }"
            >{{ (proposal.evaluationStatus ? 'proposal_evaluation.evaluationStatus_true' : 'proposal_evaluation.evaluationStatus_false') | translate }}</span
          >
          <span class="divider">|</span>
          <span class="locality-text ms-4">{{ proposal.localityName }}</span>
        </div>
        <div class="description-text my-2">
          <p>{{ proposal.description }}</p>
        </div>
  
        <div class="planItemArea-planItem">
          <span>{{  domainConfigNamesObj['planItemAreaTypeName'] }}: </span>
          <span class="planItemArea-text">{{ proposal.planItemAreaName}}</span>
          <span class="divider">></span>
          <span>{{ domainConfigNamesObj['planItemTypeName'] }}: </span>
          <span class="planItem-text">{{ proposal.planItemName }}</span>
        </div>
      </div>

      <div class="col-6 d-flex justify-content-around align-items-center">
        <div class="col-9 d-inline-flex align-content-center flex-wrap">
          <button 
            *ngFor="let orgGuid of proposal.evaluatorOrgsNameAndLoaIncludedList"
            class="org-badge"
            (click)="createOrEditProposal(proposal, orgGuid.evaluatorOrgsName)"
            [ngClass]="{
              loaIncluded: orgGuid.loaIncluded,
              'not-loaIncluded': !orgGuid.loaIncluded
            }"
          > 
            {{ getOrgName(orgGuid.evaluatorOrgsName) }}
          </button>
        </div>
  
        <div *ngIf="isEvaluationOpen && isEvaluatorOrgGuid">
          <button
            pButton
            icon="fa-solid fa-clipboard-check fa-lg"
            class="py-1 px-2"
            (click)="createOrEditProposal(proposal)"
          ></button>
        </div>
      </div>
    </div>
  </div>
